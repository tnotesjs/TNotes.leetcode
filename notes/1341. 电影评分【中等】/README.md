# [1341. ç”µå½±è¯„åˆ†ã€ä¸­ç­‰ã€‘](https://github.com/tnotesjs/TNotes.leetcode/tree/main/notes/1341.%20%E7%94%B5%E5%BD%B1%E8%AF%84%E5%88%86%E3%80%90%E4%B8%AD%E7%AD%89%E3%80%91)

<!-- region:toc -->

- [1. ğŸ“ é¢˜ç›®æè¿°](#1--é¢˜ç›®æè¿°)
- [2. ğŸ¯ s.1 - è§£æ³• 1](#2--s1---è§£æ³•-1)

<!-- endregion:toc -->

## 1. ğŸ“ é¢˜ç›®æè¿°

- [leetcode](https://leetcode.cn/problems/movie-rating/)

è¡¨ï¼š`Movies`

```txt
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| movie_id      | int     |
| title         | varchar |
+---------------+---------+
movie_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
title æ˜¯ç”µå½±çš„åå­—ã€‚
```

è¡¨ï¼š`Users`

```txt
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| user_id       | int     |
| name          | varchar |
+---------------+---------+
user_id æ˜¯è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
'name' åˆ—å…·æœ‰å”¯ä¸€å€¼ã€‚
```

è¡¨ï¼š`MovieRating`

```txt
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| movie_id      | int     |
| user_id       | int     |
| rating        | int     |
| created_at    | date    |
+---------------+---------+
(movie_id, user_id) æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆ)ã€‚
è¿™ä¸ªè¡¨åŒ…å«ç”¨æˆ·åœ¨å…¶è¯„è®ºä¸­å¯¹ç”µå½±çš„è¯„åˆ† ratingã€‚
created_at æ˜¯ç”¨æˆ·çš„ç‚¹è¯„æ—¥æœŸã€‚
```

è¯·ä½ ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼š

- æŸ¥æ‰¾è¯„è®ºç”µå½±æ•°é‡æœ€å¤šçš„ç”¨æˆ·åã€‚å¦‚æœå‡ºç°å¹³å±€ï¼Œè¿”å›å­—å…¸åºè¾ƒå°çš„ç”¨æˆ·åã€‚
- æŸ¥æ‰¾åœ¨ `February 2020` å¹³å‡è¯„åˆ†æœ€é«˜ çš„ç”µå½±åç§°ã€‚å¦‚æœå‡ºç°å¹³å±€ï¼Œè¿”å›å­—å…¸åºè¾ƒå°çš„ç”µå½±åç§°ã€‚

å­—å…¸åº ï¼Œå³æŒ‰å­—æ¯åœ¨å­—å…¸ä¸­å‡ºç°é¡ºåºå¯¹å­—ç¬¦ä¸²æ’åºï¼Œå­—å…¸åºè¾ƒå°åˆ™æ„å‘³ç€æ’åºé å‰ã€‚

è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚

---

- ç¤ºä¾‹ 1ï¼š

```txt
è¾“å…¥ï¼š
Movies è¡¨ï¼š
+-------------+--------------+
| movie_id    |  title       |
+-------------+--------------+
| 1           | Avengers     |
| 2           | Frozen 2     |
| 3           | Joker        |
+-------------+--------------+
Users è¡¨ï¼š
+-------------+--------------+
| user_id     |  name        |
+-------------+--------------+
| 1           | Daniel       |
| 2           | Monica       |
| 3           | Maria        |
| 4           | James        |
+-------------+--------------+
MovieRating è¡¨ï¼š
+-------------+--------------+--------------+-------------+
| movie_id    | user_id      | rating       | created_at  |
+-------------+--------------+--------------+-------------+
| 1           | 1            | 3            | 2020-01-12  |
| 1           | 2            | 4            | 2020-02-11  |
| 1           | 3            | 2            | 2020-02-12  |
| 1           | 4            | 1            | 2020-01-01  |
| 2           | 1            | 5            | 2020-02-17  |
| 2           | 2            | 2            | 2020-02-01  |
| 2           | 3            | 2            | 2020-03-01  |
| 3           | 1            | 3            | 2020-02-22  |
| 3           | 2            | 4            | 2020-02-25  |
+-------------+--------------+--------------+-------------+
è¾“å‡ºï¼š
Result è¡¨ï¼š
+--------------+
| results      |
+--------------+
| Daniel       |
| Frozen 2     |
+--------------+
è§£é‡Šï¼š
Daniel å’Œ Monica éƒ½ç‚¹è¯„äº† 3 éƒ¨ç”µå½±ï¼ˆ"Avengers", "Frozen 2" å’Œ "Joker"ï¼‰ ä½†æ˜¯ Daniel å­—å…¸åºæ¯”è¾ƒå°ã€‚
Frozen 2 å’Œ Joker åœ¨ 2 æœˆçš„è¯„åˆ†éƒ½æ˜¯ 3.5ï¼Œä½†æ˜¯ Frozen 2 çš„å­—å…¸åºæ¯”è¾ƒå°ã€‚
```

## 2. ğŸ¯ s.1 - è§£æ³• 1

::: code-group

<<< ./solutions/1/1.js [js]

:::

- æ—¶é—´å¤æ‚åº¦ï¼š$O(1)$
- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$
