# [0367. 有效的完全平方数【简单】](https://github.com/tnotesjs/TNotes.leetcode/tree/main/notes/0367.%20%E6%9C%89%E6%95%88%E7%9A%84%E5%AE%8C%E5%85%A8%E5%B9%B3%E6%96%B9%E6%95%B0%E3%80%90%E7%AE%80%E5%8D%95%E3%80%91)

<!-- region:toc -->

- [1. 📝 题目描述](#1--题目描述)
- [2. 🎯 s.1 - 二分查找](#2--s1---二分查找)

<!-- endregion:toc -->

## 1. 📝 题目描述

- [leetcode](https://leetcode.cn/problems/valid-perfect-square/)

给你一个正整数 `num` 。如果 `num` 是一个完全平方数，则返回 `true` ，否则返回 `false` 。

完全平方数 是一个可以写成某个整数的平方的整数。换句话说，它可以写成某个整数和自身的乘积。

不能使用任何内置的库函数，如 `sqrt` 。

---

- 示例 1：

```txt
输入：num = 16
输出：true
解释：返回 true ，因为 4 * 4 = 16 且 4 是一个整数。
```

- 示例 2：

```txt
输入：num = 14
输出：false
解释：返回 false ，因为 3.742 * 3.742 = 14 但 3.742 不是一个整数。
```

---

提示：

- `1 <= num <= 2^31 - 1`

## 2. 🎯 s.1 - 二分查找

::: code-group

<<< ./solutions/1/1.js [js]

:::

- 时间复杂度：$O(\log n)$，二分查找的时间复杂度
- 空间复杂度：$O(1)$，只使用了常数级别的额外空间
- 解题思路：
  - 特殊情况处理：当 `num` 为 1 时，直接返回 `true`
  - 搜索范围优化：对于大于 1 的数，其平方根不会超过 `num/2`，所以右边界设为 `Math.floor(num / 2)`
    - 🤔 为什么 `Math.floor(num / 2)` 是安全的？
    - 对于 `num = 1` → 特殊情况已经判定了，不会进入后续的二分查找循环中
    - 对于 `num = 2, 3` → 虽然 `sqrt(num) > num/2`，但它们不是完全平方数 → 二分查找找不到，返回 `false`，结果正确
    - 对于 `num ≥ 4` → `sqrt(num) ≤ num/2`，搜索区间 `[1, num/2]` 包含真实解
    - 其实这个搜索区间还是太大了，还可以进一步优化，比如写成：`let right = Math.floor(Math.sqrt(num)) + 1`，但是这么写不符合题目的要求 —— 不要使用内置的 `sqrt`。
  - 二分查找：
    - 计算中间值 `mid` 的平方
    - 如果平方等于 `num`，则找到了完全平方根，返回 `true`
    - 如果平方小于 `num`，说明平方根在右半部分，调整左边界
    - 如果平方大于 `num`，说明平方根在左半部分，调整右边界
  - 结束条件：当 `left > right` 时，搜索结束，返回 `false`
