# [3539. 魔法序列的数组乘积之和【困难】](https://github.com/tnotesjs/TNotes.leetcode/tree/main/notes/3539.%20%E9%AD%94%E6%B3%95%E5%BA%8F%E5%88%97%E7%9A%84%E6%95%B0%E7%BB%84%E4%B9%98%E7%A7%AF%E4%B9%8B%E5%92%8C%E3%80%90%E5%9B%B0%E9%9A%BE%E3%80%91)

<!-- region:toc -->

- [1. 📝 题目描述](#1--题目描述)
- [2. 🎯 s.1 - 解法 1](#2--s1---解法-1)
- [3. 🎯 s.2 - 解法 2](#3--s2---解法-2)
- [4. 🎯 s.3 - 解法 3](#4--s3---解法-3)

<!-- endregion:toc -->

## 1. 📝 题目描述

- [leetcode](https://leetcode.cn/problems/find-sum-of-array-product-of-magical-sequences/)

给你两个整数 `M` 和 `K`，和一个整数数组 `nums`。

一个整数序列 `seq` 如果满足以下条件，被称为 **魔法** 序列：

- `seq` 的序列长度为 `M`。
- `0 <= seq[i] < nums.length`
- `2^seq[0] + 2^seq[1] + ... + 2^seq[M - 1]` 的 **二进制形式** 有 `K` 个 **置位**。

这个序列的 **数组乘积** 定义为 `prod(seq) = (nums[seq[0]] * nums[seq[1]] * ... * nums[seq[M - 1]])`。

返回所有有效 **魔法** 序列的 **数组乘积** 的 **总和** 。

由于答案可能很大，返回结果对 `10^9 + 7` **取模**。

**置位** 是指一个数字的二进制表示中值为 1 的位。

---

- **示例 1:**

**输入:** M = 5, K = 5, nums = [1,10,100,10000,1000000]

**输出:** 991600007

**解释:**

所有 `[0, 1, 2, 3, 4]` 的排列都是魔法序列，每个序列的数组乘积是 10^13。

---

- **示例 2:**

**输入:** M = 2, K = 2, nums = [5,4,3,2,1]

**输出:** 170

**解释:**

魔法序列有 `[0, 1]`，`[0, 2]`，`[0, 3]`，`[0, 4]`，`[1, 0]`，`[1, 2]`，`[1, 3]`，`[1, 4]`，`[2, 0]`，`[2, 1]`，`[2, 3]`，`[2, 4]`，`[3, 0]`，`[3, 1]`，`[3, 2]`，`[3, 4]`，`[4, 0]`，`[4, 1]`，`[4, 2]` 和 `[4, 3]`。

---

- **示例 3:**

**输入:** M = 1, K = 1, nums = [28]

**输出:** 28

**解释:**

唯一的魔法序列是 `[0]`。

---

**提示:**

- `1 <= K <= M <= 30`
- `1 <= nums.length <= 50`
- `1 <= nums[i] <= 10^8`

## 2. 🎯 s.1 - 解法 1

::: code-group

<<< ./solutions/1/1.js [js]

:::

- 时间复杂度：$O(1)$
- 空间复杂度：$O(1)$

## 3. 🎯 s.2 - 解法 2

::: code-group

<<< ./solutions/2/1.js [js]

:::

- 时间复杂度：$O(1)$
- 空间复杂度：$O(1)$

## 4. 🎯 s.3 - 解法 3

::: code-group

<<< ./solutions/3/1.js [js]

:::

- 时间复杂度：$O(1)$
- 空间复杂度：$O(1)$
