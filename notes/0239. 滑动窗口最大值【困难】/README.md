# [0239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼ã€å›°éš¾ã€‘](https://github.com/Tdahuyou/TNotes.leetcode/tree/main/notes/0239.%20%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E6%9C%80%E5%A4%A7%E5%80%BC%E3%80%90%E5%9B%B0%E9%9A%BE%E3%80%91)

<!-- region:toc -->

- [1. ğŸ“ Description](#1--description)
- [2. ğŸ’» é¢˜è§£.1 - Deque](#2--é¢˜è§£1---deque)
- [3. ğŸ¤– ä»€ä¹ˆæ˜¯åŒç«¯é˜Ÿåˆ—ï¼Ÿ](#3--ä»€ä¹ˆæ˜¯åŒç«¯é˜Ÿåˆ—)
  - [3.1. ç‰¹æ€§](#31-ç‰¹æ€§)
  - [3.2. å¸¸è§æ“ä½œ](#32-å¸¸è§æ“ä½œ)
  - [3.3. ç”¨é€”](#33-ç”¨é€”)
  - [3.4. ç¤ºä¾‹](#34-ç¤ºä¾‹)
  - [3.5. å…³é”®ç‚¹](#35-å…³é”®ç‚¹)

<!-- endregion:toc -->
- [leetcode](https://leetcode.cn/problems/sliding-window-maximum)



## 1. ğŸ“ Description

::: details [leetcode](https://leetcode.cn)

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums`ï¼Œæœ‰ä¸€ä¸ªå¤§å°ä¸ºÂ `k`Â çš„æ»‘åŠ¨çª—å£ä»æ•°ç»„çš„æœ€å·¦ä¾§ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ä¾§ã€‚ä½ åªå¯ä»¥çœ‹åˆ°åœ¨æ»‘åŠ¨çª—å£å†…çš„ `k`Â ä¸ªæ•°å­—ã€‚æ»‘åŠ¨çª—å£æ¯æ¬¡åªå‘å³ç§»åŠ¨ä¸€ä½ã€‚

è¿”å› _æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼_ ã€‚

**ç¤ºä¾‹ 1ï¼š**

- è¾“å…¥ï¼šnums = [1,3,-1,-3,5,3,6,7], k = 3
- è¾“å‡ºï¼š[3,3,5,5,6,7]
- è§£é‡Šï¼š

| æ»‘åŠ¨çª—å£çš„ä½ç½®            | æœ€å¤§å€¼ |
| ------------------------- | ------ |
| [1  3  -1] -3  5  3  6  7 | 3      |
| 1 [3  -1  -3] 5  3  6  7  | 3      |
| 1  3 [-1  -3  5] 3  6  7  | 5      |
| 1  3  -1 [-3  5  3] 6  7  | 5      |
| 1  3  -1  -3 [5  3  6] 7  | 6      |
| 1  3  -1  -3  5 [3  6  7] | 7      |

**ç¤ºä¾‹ 2ï¼š**

- è¾“å…¥ï¼šnums = [1], k = 1
- è¾“å‡ºï¼š[1]

**æç¤ºï¼š**

- `1 <= nums.length <= 10^5`
- `-10^4Â <= nums[i] <= 10^4`
- `1 <= k <= nums.length`

## 2. ğŸ’» é¢˜è§£.1 - Deque

![](assets/2024-09-25-17-07-42.png)

> å›¾ç‰‡æ¥æºï¼šhttps://leetcode.cn/problems/sliding-window-maximum/solutions/2361228/239-hua-dong-chuang-kou-zui-da-zhi-dan-d-u6h0

```javascript
/**
 * @param {number[]} nums
 * @param {number} k
 * @return {number[]}
 */
var maxSlidingWindow = function(nums, k) {
  const deque = [] // ç”¨äºç»´æŠ¤æˆå‘˜ç´¢å¼•çš„ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—
  const max = [] // å­˜å‚¨æ¯ä¸ªçª—å£çš„æœ€å¤§å€¼

  for (let i = 0; i < nums.length; i++) {
    // 1. æŠŠæº¢å‡ºçª—å£å°ºå¯¸çš„æˆå‘˜ç§»é™¤
    if (deque.length > 0 && deque[0] < i - k + 1) deque.shift()

    // 2. ç¡®ä¿ deque ä¸­å­˜æ”¾çš„ç´¢å¼•å¯¹åº”çš„æˆå‘˜æ˜¯éä¸¥æ ¼é€’å‡ï¼ˆ<ï¼‰ã€ä¸¥æ ¼é€’å‡ï¼ˆ<=ï¼‰
    while (deque.length > 0 && nums[deque[deque.length - 1]] <= nums[i]) deque.pop()

    // 3. æŠŠå½“å‰é¡¹åŠ å…¥åˆ° deque ä¸­
    deque.push(i)

    // 4. å°† deque[0] ä¸¢åˆ° max é‡Œè¾¹
    if (i >= k - 1) max.push(nums[deque[0]])
  }

  return max
};
```

- æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$
- ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

**æ‰§è¡Œæµç¨‹ç¤ºä¾‹**

ä¸‹é¢ä»¥ç¤ºä¾‹ 1 ä¸ºä¾‹æ¥è¿›è¡Œåˆ†æã€‚

**ç¤ºä¾‹ 1ï¼š**

- è¾“å…¥ï¼šnums = [1,3,-1,-3,5,3,6,7], k = 3
- è¾“å‡ºï¼š[3,3,5,5,6,7]
- è§£é‡Šï¼š

| æ»‘åŠ¨çª—å£çš„ä½ç½®            | æœ€å¤§å€¼ |
| ------------------------- | ------ |
| [1  3  -1] -3  5  3  6  7 | 3      |
| 1 [3  -1  -3] 5  3  6  7  | 3      |
| 1  3 [-1  -3  5] 3  6  7  | 5      |
| 1  3  -1 [-3  5  3] 6  7  | 5      |
| 1  3  -1  -3 [5  3  6] 7  | 6      |
| 1  3  -1  -3  5 [3  6  7] | 7      |

1. **åˆå§‹åŒ–**
- `deque = []` åŒç«¯é˜Ÿåˆ—
- `max = []` å­˜æ”¾æ¯ä¸ªçª—å£çš„æœ€å¤§å€¼
2. **éå†æ•°ç»„**
- **i = 0**ï¼š
    - å½“å‰å…ƒç´ æ˜¯ `1`
    - é˜Ÿåˆ—ä¸ºç©ºï¼Œç›´æ¥æ·»åŠ å…ƒç´ ç´¢å¼• `0` åˆ° `deque`
    - `deque = [0]`
    - å½“å‰çª—å£é•¿åº¦å°äº `k`ï¼Œä¸è®°å½•æœ€å¤§å€¼
- **i = 1**ï¼š
    - å½“å‰å…ƒç´ æ˜¯ `3`
    - é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œç§»é™¤é˜Ÿåˆ—ä¸­æ‰€æœ‰å°äº `3` çš„å…ƒç´ 
    - `nums[0] ç»“æœæ˜¯ 1 < 3`ï¼Œç§»é™¤ç´¢å¼• `0`
    - æ·»åŠ å…ƒç´ ç´¢å¼• `1` åˆ° `deque`
    - `deque = [1]`
    - å½“å‰çª—å£é•¿åº¦å°äº `k`ï¼Œä¸è®°å½•æœ€å¤§å€¼
- **i = 2**ï¼š
    - å½“å‰å…ƒç´ æ˜¯ `-1`
    - é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œæ²¡æœ‰å…ƒç´ å°äº `-1`
    - æ·»åŠ å…ƒç´ ç´¢å¼• `2` åˆ° `deque`
    - `deque = [1, 2]`
    - å½“å‰çª—å£é•¿åº¦ç­‰äº `k`ï¼Œè®°å½•å½“å‰çª—å£çš„æœ€å¤§å€¼
    - `max = [nums[1]] = [3]`
- **i = 3**ï¼š
    - å½“å‰å…ƒç´ æ˜¯ `-3`
    - é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œæ²¡æœ‰å…ƒç´ å°äº `-3`
    - æ·»åŠ å…ƒç´ ç´¢å¼• `3` åˆ° `deque`
    - `deque = [1, 2, 3]`
    - å½“å‰çª—å£é•¿åº¦ç­‰äº `k`ï¼Œè®°å½•å½“å‰çª—å£çš„æœ€å¤§å€¼
    - `max = [3, nums[1]] = [3, 3]`
- **i = 4**ï¼š
    - å½“å‰å…ƒç´ æ˜¯ `5`
    - ç§»é™¤ä¸åœ¨å½“å‰çª—å£èŒƒå›´å†…çš„å…ƒç´ 
    - `deque[0] = 1`ï¼Œåœ¨çª—å£èŒƒå›´å†…ï¼Œä¸ç§»é™¤
    - ç§»é™¤é˜Ÿåˆ—ä¸­æ‰€æœ‰å°äº `5` çš„å…ƒç´ 
    - `nums[3] ç»“æœæ˜¯ -3 < 5`ï¼Œç§»é™¤ç´¢å¼• `3`
    - `nums[2] ç»“æœæ˜¯ -1 < 5`ï¼Œç§»é™¤ç´¢å¼• `2`
    - `nums[1] ç»“æœæ˜¯ 3 < 5`ï¼Œç§»é™¤ç´¢å¼• `1`
    - æ·»åŠ å…ƒç´ ç´¢å¼• `4` åˆ° `deque`
    - `deque = [4]`
    - å½“å‰çª—å£é•¿åº¦ç­‰äº `k`ï¼Œè®°å½•å½“å‰çª—å£çš„æœ€å¤§å€¼
    - `max = [3, 3, nums[4]] = [3, 3, 5]`
- **i = 5**ï¼š
    - å½“å‰å…ƒç´ æ˜¯ `3`
    - é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œæ²¡æœ‰å…ƒç´ å°äº `3`
    - æ·»åŠ å…ƒç´ ç´¢å¼• `5` åˆ° `deque`
    - `deque = [4, 5]`
    - å½“å‰çª—å£é•¿åº¦ç­‰äº `k`ï¼Œè®°å½•å½“å‰çª—å£çš„æœ€å¤§å€¼
    - `max = [3, 3, 5, nums[4]] = [3, 3, 5, 5]`
- **i = 6**ï¼š
    - å½“å‰å…ƒç´ æ˜¯ `6`
    - ç§»é™¤ä¸åœ¨å½“å‰çª—å£èŒƒå›´å†…çš„å…ƒç´ 
    - `deque[0] = 4`ï¼Œåœ¨çª—å£èŒƒå›´å†…ï¼Œä¸ç§»é™¤
    - ç§»é™¤é˜Ÿåˆ—ä¸­æ‰€æœ‰å°äº `6` çš„å…ƒç´ 
    - `nums[5] ç»“æœæ˜¯ 3 < 6`ï¼Œç§»é™¤ç´¢å¼• `5`
    - `nums[4] ç»“æœæ˜¯ 5 < 6`ï¼Œç§»é™¤ç´¢å¼• `4`
    - æ·»åŠ å…ƒç´ ç´¢å¼• `6` åˆ° `deque`
    - `deque = [6]`
    - å½“å‰çª—å£é•¿åº¦ç­‰äº `k`ï¼Œè®°å½•å½“å‰çª—å£çš„æœ€å¤§å€¼
    - `max = [3, 3, 5, 5, nums[6]] = [3, 3, 5, 5, 6]`
- **i = 7**ï¼š
    - å½“å‰å…ƒç´ æ˜¯ `7`
    - ç§»é™¤ä¸åœ¨å½“å‰çª—å£èŒƒå›´å†…çš„å…ƒç´ 
    - `deque[0] = 6`ï¼Œåœ¨çª—å£èŒƒå›´å†…ï¼Œä¸ç§»é™¤
    - ç§»é™¤é˜Ÿåˆ—ä¸­æ‰€æœ‰å°äº `7` çš„å…ƒç´ 
    - `nums[6] ç»“æœæ˜¯ 6 < 7`ï¼Œç§»é™¤ç´¢å¼• `6`
    - æ·»åŠ å…ƒç´ ç´¢å¼• `7` åˆ° `deque`
    - `deque = [7]`
    - å½“å‰çª—å£é•¿åº¦ç­‰äº `k`ï¼Œè®°å½•å½“å‰çª—å£çš„æœ€å¤§å€¼
    - `max = [3, 3, 5, 5, 6, nums[7]] = [3, 3, 5, 5, 6, 7]`

æœ€ç»ˆè¿”å›çš„ç»“æœæ˜¯`[3, 3, 5, 5, 6, 7]`ã€‚

## 3. ğŸ¤– ä»€ä¹ˆæ˜¯åŒç«¯é˜Ÿåˆ—ï¼Ÿ

åŒç«¯é˜Ÿåˆ—ï¼ˆDequeï¼Œå…¨ç§°ä¸º Double-Ended Queueï¼‰æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…è®¸åœ¨ä¸¤ç«¯è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚å®ƒç»“åˆäº† **æ ˆ** å’Œ **é˜Ÿåˆ—** çš„ç‰¹æ€§ï¼Œå› æ­¤æ—¢å¯ä»¥é«˜æ•ˆåœ°ä»ä¸¤ç«¯æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œåˆèƒ½åƒé˜Ÿåˆ—ä¸€æ ·æŒ‰é¡ºåºè®¿é—®å…ƒç´ ã€‚

### 3.1. ç‰¹æ€§
- **æ’å…¥å’Œåˆ é™¤æ“ä½œ**ï¼šå¯ä»¥åœ¨é˜Ÿé¦–ï¼ˆfrontï¼‰å’Œé˜Ÿå°¾ï¼ˆrearï¼‰è¿›è¡Œå…ƒç´ çš„æ’å…¥å’Œåˆ é™¤ã€‚
- **åŒå‘æ“ä½œ**ï¼šå…è®¸ä»ä¸¤ç«¯è¿›è¡Œè®¿é—®ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚

### 3.2. å¸¸è§æ“ä½œ
- `push_front(item)`ï¼šåœ¨é˜Ÿé¦–æ’å…¥å…ƒç´ ã€‚
- `push_back(item)`ï¼šåœ¨é˜Ÿå°¾æ’å…¥å…ƒç´ ã€‚
- `pop_front()`ï¼šä»é˜Ÿé¦–ç§»é™¤å…ƒç´ ã€‚
- `pop_back()`ï¼šä»é˜Ÿå°¾ç§»é™¤å…ƒç´ ã€‚
- `front()`ï¼šè¿”å›é˜Ÿé¦–çš„å…ƒç´ ã€‚
- `back()`ï¼šè¿”å›é˜Ÿå°¾çš„å…ƒç´ ã€‚
- `is_empty()`ï¼šæ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚
- `size()`ï¼šè¿”å›é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°ã€‚

### 3.3. ç”¨é€”
åŒç«¯é˜Ÿåˆ—åœ¨å¾ˆå¤šç®—æ³•å’Œåº”ç”¨ä¸­éƒ½æœ‰å¹¿æ³›çš„ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦åœ¨ä¸¤ç«¯è¿›è¡Œé«˜æ•ˆæ’å…¥å’Œåˆ é™¤æ“ä½œçš„åœºæ™¯ã€‚ä¾‹å¦‚ï¼š

- å®ç°æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼æˆ–æœ€å°å€¼ç®—æ³•ã€‚
- å®ç°ä»»åŠ¡è°ƒåº¦ï¼Œæ”¯æŒåœ¨é˜Ÿåˆ—ä¸¤ç«¯æ’å…¥å’Œå¤„ç†ä»»åŠ¡ã€‚
- å®ç°æµè§ˆå™¨çš„å‰è¿›å’Œåé€€åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·åœ¨è®¿é—®å†å²è®°å½•ä¸­å‰åç§»åŠ¨ã€‚

### 3.4. ç¤ºä¾‹
ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨åŒç«¯é˜Ÿåˆ—å®ç°æ»‘åŠ¨çª—å£æœ€å¤§å€¼çš„ç¤ºä¾‹ï¼š

```javascript
class Deque {
  constructor() {
    this.items = [];
  }

  push_front(item) {
    this.items.unshift(item);
  }

  push_back(item) {
    this.items.push(item);
  }

  pop_front() {
    return this.items.shift();
  }

  pop_back() {
    return this.items.pop();
  }

  front() {
    return this.items[0];
  }

  back() {
    return this.items[this.items.length - 1];
  }

  is_empty() {
    return this.items.length === 0;
  }

  size() {
    return this.items.length;
  }
}

// ä½¿ç”¨åŒç«¯é˜Ÿåˆ—å®ç°æ»‘åŠ¨çª—å£æœ€å¤§å€¼
function maxSlidingWindow(nums, k) {
  const deque = new Deque();
  const max = [];

  for (let i = 0; i < nums.length; i++) {
    // ç§»é™¤ä¸åœ¨å½“å‰çª—å£èŒƒå›´å†…çš„å…ƒç´ 
    if (!deque.is_empty() && deque.front() < i - k + 1) {
      deque.pop_front();
    }

    // ç§»é™¤é˜Ÿåˆ—ä¸­æ‰€æœ‰å°äºå½“å‰å…ƒç´ çš„å…ƒç´ 
    while (!deque.is_empty() && nums[deque.back()] <= nums[i]) {
      deque.pop_back();
    }

    // å°†å½“å‰å…ƒç´ æ·»åŠ åˆ°é˜Ÿåˆ—
    deque.push_back(i);

    // å½“çª—å£é•¿åº¦å¤§äºç­‰äº k æ—¶ï¼Œè®°å½•å½“å‰çª—å£çš„æœ€å¤§å€¼
    if (i >= k - 1) {
      max.push(nums[deque.front()]);
    }
  }

  return max;
}

const nums = [1, 3, -1, -3, 5, 3, 6, 7];
const k = 3;
console.log(maxSlidingWindow(nums, k)); // è¾“å‡º: [3, 3, 5, 5, 6, 7]
```

### 3.5. å…³é”®ç‚¹
- ä½¿ç”¨åŒç«¯é˜Ÿåˆ—å¯ä»¥é«˜æ•ˆåœ°å®ç°æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼é—®é¢˜ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ã€‚
- åŒç«¯é˜Ÿåˆ—èƒ½å¤Ÿåœ¨å¸¸æ•°æ—¶é—´å†…å®Œæˆä»ä¸¤ç«¯çš„æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œä½¿å¾—ä¸€äº›å¤æ‚çš„ç®—æ³•èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°å®ç°ã€‚
