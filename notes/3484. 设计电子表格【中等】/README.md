# [3484. è®¾è®¡ç”µå­è¡¨æ ¼ã€ä¸­ç­‰ã€‘](https://github.com/tnotesjs/TNotes.leetcode/tree/main/notes/3484.%20%E8%AE%BE%E8%AE%A1%E7%94%B5%E5%AD%90%E8%A1%A8%E6%A0%BC%E3%80%90%E4%B8%AD%E7%AD%89%E3%80%91)

<!-- region:toc -->

- [1. ğŸ“ é¢˜ç›®æè¿°](#1--é¢˜ç›®æè¿°)
- [2. ğŸ¯ s.1 - è§£æ³• 1](#2--s1---è§£æ³•-1)
- [3. ğŸ¯ s.2 - è§£æ³• 2](#3--s2---è§£æ³•-2)
- [4. ğŸ¯ s.3 - è§£æ³• 3](#4--s3---è§£æ³•-3)

<!-- endregion:toc -->

## 1. ğŸ“ é¢˜ç›®æè¿°

- [leetcode](https://leetcode.cn/problems/design-spreadsheet/)

ç”µå­è¡¨æ ¼æ˜¯ä¸€ä¸ªç½‘æ ¼ï¼Œå®ƒæœ‰ 26 åˆ—ï¼ˆä» `'A'` åˆ° `'Z'`ï¼‰å’ŒæŒ‡å®šæ•°é‡çš„ `rows`ã€‚æ¯ä¸ªå•å…ƒæ ¼å¯ä»¥å­˜å‚¨ä¸€ä¸ª 0 åˆ° 10^5 ä¹‹é—´çš„æ•´æ•°å€¼ã€‚

è¯·ä½ å®ç°ä¸€ä¸ª `Spreadsheet` ç±»ï¼š

- `Spreadsheet(int rows)` åˆå§‹åŒ–ä¸€ä¸ªå…·æœ‰ 26 åˆ—ï¼ˆä» `'A'` åˆ° `'Z'`ï¼‰å’ŒæŒ‡å®šè¡Œæ•°çš„ç”µå­è¡¨æ ¼ã€‚æ‰€æœ‰å•å…ƒæ ¼æœ€åˆçš„å€¼éƒ½ä¸º 0 ã€‚
- `void setCell(String cell, int value)` è®¾ç½®æŒ‡å®šå•å…ƒæ ¼çš„å€¼ã€‚å•å…ƒæ ¼å¼•ç”¨ä»¥ `"AX"` çš„æ ¼å¼æä¾›ï¼ˆä¾‹å¦‚ï¼Œ`"A1"`ï¼Œ`"B10"`ï¼‰ï¼Œå…¶ä¸­å­—æ¯è¡¨ç¤ºåˆ—ï¼ˆä» `'A'` åˆ° `'Z'`ï¼‰ï¼Œæ•°å­—è¡¨ç¤ºä» **1** å¼€å§‹çš„è¡Œå·ã€‚
- `void resetCell(String cell)` é‡ç½®æŒ‡å®šå•å…ƒæ ¼çš„å€¼ä¸º 0 ã€‚
- `int getValue(String formula)` è®¡ç®—ä¸€ä¸ªå…¬å¼çš„å€¼ï¼Œæ ¼å¼ä¸º `"=X+Y"`ï¼Œå…¶ä¸­ `X` å’Œ `Y` **è¦ä¹ˆ** æ˜¯å•å…ƒæ ¼å¼•ç”¨ï¼Œè¦ä¹ˆéè´Ÿæ•´æ•°ï¼Œè¿”å›è®¡ç®—çš„å’Œã€‚

---

**æ³¨æ„ï¼š** å¦‚æœ `getValue` å¼•ç”¨ä¸€ä¸ªæœªé€šè¿‡ `setCell` æ˜ç¡®è®¾ç½®çš„å•å…ƒæ ¼ï¼Œåˆ™è¯¥å•å…ƒæ ¼çš„å€¼é»˜è®¤ä¸º 0 ã€‚

---

- **ç¤ºä¾‹ 1ï¼š**

**è¾“å…¥ï¼š**

["Spreadsheet", "getValue", "setCell", "getValue", "setCell", "getValue", "resetCell", "getValue"]  
[[3], ["=5+7"], ["A1", 10], ["=A1+6"], ["B2", 15], ["=A1+B2"], ["A1"], ["=A1+B2"]]

**è¾“å‡ºï¼š**

[null, 12, null, 16, null, 25, null, 15]

**è§£é‡Š**

```txt
Spreadsheet spreadsheet = new Spreadsheet(3); // åˆå§‹åŒ–ä¸€ä¸ªå…·æœ‰ 3 è¡Œå’Œ 26 åˆ—çš„ç”µå­è¡¨æ ¼
spreadsheet.getValue("=5+7"); // è¿”å› 12 (5+7)
spreadsheet.setCell("A1", 10); // è®¾ç½® A1 ä¸º 10
spreadsheet.getValue("=A1+6"); // è¿”å› 16 (10+6)
spreadsheet.setCell("B2", 15); // è®¾ç½® B2 ä¸º 15
spreadsheet.getValue("=A1+B2"); // è¿”å› 25 (10+15)
spreadsheet.resetCell("A1"); // é‡ç½® A1 ä¸º 0
spreadsheet.getValue("=A1+B2"); // è¿”å› 15 (0+15)
```

---

**æç¤ºï¼š**

- `1 <= rows <= 10^3`
- `0 <= value <= 10^5`
- å…¬å¼ä¿è¯é‡‡ç”¨ `"=X+Y"` æ ¼å¼ï¼Œå…¶ä¸­ `X` å’Œ `Y` è¦ä¹ˆæ˜¯æœ‰æ•ˆçš„å•å…ƒæ ¼å¼•ç”¨ï¼Œè¦ä¹ˆæ˜¯å°äºç­‰äº `10^5` çš„ **éè´Ÿ** æ•´æ•°ã€‚
- æ¯ä¸ªå•å…ƒæ ¼å¼•ç”¨ç”±ä¸€ä¸ªå¤§å†™å­—æ¯ `'A'` åˆ° `'Z'` å’Œä¸€ä¸ªä»‹äº `1` å’Œ `rows` ä¹‹é—´çš„è¡Œå·ç»„æˆã€‚
- **æ€»å…±** æœ€å¤šä¼šå¯¹ `setCell`ã€`resetCell` å’Œ `getValue` è°ƒç”¨ `10^4` æ¬¡ã€‚

## 2. ğŸ¯ s.1 - è§£æ³• 1

::: code-group

<<< ./solutions/1/1.js [js]

:::

- æ—¶é—´å¤æ‚åº¦ï¼š$O(1)$
- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

## 3. ğŸ¯ s.2 - è§£æ³• 2

::: code-group

<<< ./solutions/2/1.js [js]

:::

- æ—¶é—´å¤æ‚åº¦ï¼š$O(1)$
- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

## 4. ğŸ¯ s.3 - è§£æ³• 3

::: code-group

<<< ./solutions/3/1.js [js]

:::

- æ—¶é—´å¤æ‚åº¦ï¼š$O(1)$
- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$
