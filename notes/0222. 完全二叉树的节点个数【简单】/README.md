# [0222. 完全二叉树的节点个数【简单】](https://github.com/tnotesjs/TNotes.leetcode/tree/main/notes/0222.%20%E5%AE%8C%E5%85%A8%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E8%8A%82%E7%82%B9%E4%B8%AA%E6%95%B0%E3%80%90%E7%AE%80%E5%8D%95%E3%80%91)

<!-- region:toc -->

- [1. 📝 题目描述](#1--题目描述)
- [2. 🎯 s.1 - 暴力解法普通递归遍历](#2--s1---暴力解法普通递归遍历)
- [3. 🎯 s.2 - 利用完全二叉树特性优化递归](#3--s2---利用完全二叉树特性优化递归)
- [4. 🔗 引用](#4--引用)

<!-- endregion:toc -->

## 1. 📝 题目描述

- [leetcode](https://leetcode.cn/problems/count-complete-tree-nodes/)

给你一棵完全二叉树的根节点 `root` ，求出该树的节点个数。

[完全二叉树][1] 的定义如下：在完全二叉树中，除了最底层节点可能没填满外，其余每层节点数都达到最大值，并且最下面一层的节点都集中在该层最左边的若干位置。若最底层为第 `h` 层（从第 0 层开始），则该层包含 `1~ 2^h` 个节点。

---

示例 1：

![img](https://cdn.jsdelivr.net/gh/tnotesjs/imgs@main/2025-09-09-13-39-40.png)

```txt
输入：root = [1,2,3,4,5,6]
输出：6
```

---

示例 2：

```txt
输入：root = []
输出：0
```

---

示例 3：

```txt
输入：root = [1]
输出：1
```

---

提示：

- 树中节点的数目范围是`[0, 5 * 10^4]`
- `0 <= Node.val <= 5 * 10^4`
- 题目数据保证输入的树是 完全二叉树

进阶：遍历树来统计节点是一种时间复杂度为 `O(n)` 的简单解决方案。你可以设计一个更快的算法吗？

## 2. 🎯 s.1 - 暴力解法普通递归遍历

::: code-group

<<< ./solutions/1/1.js

:::

- 时间复杂度：$O(n)$，需要访问每个节点
- 空间复杂度：$O(\log n)$，递归调用栈的深度

解题思路：

- 递归遍历整棵树，计算节点总数
- 递归公式：节点总数 = 1（当前节点） + 左子树节点数 + 右子树节点数
- 这是最直接的解法，但没有利用完全二叉树的特性

## 3. 🎯 s.2 - 利用完全二叉树特性优化递归

::: code-group

<<< ./solutions/2/1.js

:::

- 时间复杂度：$O(\log^2 n)$，每次递归需要 $O(\log n)$ 时间计算高度，最多递归 $O(\log n)$ 次
- 空间复杂度：$O(\log n)$，递归调用栈的深度

解题思路：

- 利用完全二叉树的性质：除最后一层外，其他层都是满的
- 比较左右子树的高度（沿着最左路径计算）
- 如果左右高度相等，左子树必是满二叉树，用公式 $2^h$ 直接计算，递归右子树
- 如果左右高度不等，右子树必是满二叉树，用公式计算，递归左子树
- 位运算 `1 << h` 等价于 $2^h$，效率更高

## 4. 🔗 引用

- [百度百科 - 完全二叉树][1]

[1]: https://baike.baidu.com/item/%E5%AE%8C%E5%85%A8%E4%BA%8C%E5%8F%89%E6%A0%91/7773232?fr=aladdin
